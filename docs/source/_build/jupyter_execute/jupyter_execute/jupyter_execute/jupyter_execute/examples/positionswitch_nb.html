<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Position-switched Data Reduction &mdash; dysh 0.2.0 documentation</title>
      <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script src="../../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../index.html">
            
              <img src="../../../../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.2.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../background/index.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../getting_started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../design/index.html">Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../gui/index.html">GUI Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../modules/index.html">Modules and APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../examples/index.html">Examples for GBT Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../performance_testing/index.html">Performance Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../for_beta_testers/index.html">For Beta Testers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../for_developers/index.html">For Developers</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">dysh</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Position-switched Data Reduction</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../_sources/jupyter_execute/jupyter_execute/jupyter_execute/jupyter_execute/examples/positionswitch_nb.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="position-switched-data-reduction">
<h1>Position-switched Data Reduction<a class="headerlink" href="#position-switched-data-reduction" title="Permalink to this heading">ÔÉÅ</a></h1>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dysh.fits.gbtfitsload</span> <span class="kn">import</span> <span class="n">GBTFITSLoad</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="s1">&#39;/data/gbt/examples/onoff-L/data/TGBT21A_501_11.raw.vegas.fits&#39;</span>
<span class="n">sdfits</span> <span class="o">=</span> <span class="n">GBTFITSLoad</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">sdfits</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">f</span> <span class="o">=</span> <span class="s1">&#39;/data/gbt/examples/onoff-L/data/TGBT21A_501_11.raw.vegas.fits&#39;</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">sdfits</span> <span class="o">=</span> <span class="n">GBTFITSLoad</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">sdfits</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>

<span class="nn">File ~/Documents/Code/repos/github/dysh/src/dysh/fits/gbtfitsload.py:28,</span> in <span class="ni">GBTFITSLoad.__init__</span><span class="nt">(self, filename, source, hdu, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">27</span> <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">hdu</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">28</span>     <span class="n">SDFITSLoad</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="p">,</span><span class="n">source</span><span class="p">,</span><span class="n">hdu</span><span class="p">)</span><span class="c1">#,fix=False)</span>
<span class="g g-Whitespace">     </span><span class="mi">30</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_compute_proc</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">31</span>     <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span><span class="kc">None</span><span class="p">):</span>

<span class="nn">File ~/Documents/Code/repos/github/dysh/src/dysh/fits/sdfitsload.py:57,</span> in <span class="ni">SDFITSLoad.__init__</span><span class="nt">(self, filename, source, hdu, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">55</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binheader</span> <span class="o">=</span> <span class="p">[]</span>
<span class="g g-Whitespace">     </span><span class="mi">56</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="ne">---&gt; </span><span class="mi">57</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">58</span> <span class="bp">self</span><span class="o">.</span><span class="n">_primaryheader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span>
<span class="g g-Whitespace">     </span><span class="mi">59</span> <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">hdu</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_opts</span><span class="p">)</span>

<span class="nn">File ~/Documents/Code/repos/github/dysh/dysh-env-3.8/lib/python3.8/site-packages/astropy/io/fits/hdu/hdulist.py:214,</span> in <span class="ni">fitsopen</span><span class="nt">(name, mode, memmap, save_backup, cache, lazy_load_hdus, ignore_missing_simple, use_fsspec, fsspec_kwargs, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">211</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">212</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Empty filename: </span><span class="si">{</span><span class="n">name</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">214</span> <span class="k">return</span> <span class="n">HDUList</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">215</span>     <span class="n">name</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">216</span>     <span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">217</span>     <span class="n">memmap</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">218</span>     <span class="n">save_backup</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">219</span>     <span class="n">cache</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">220</span>     <span class="n">lazy_load_hdus</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">221</span>     <span class="n">ignore_missing_simple</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">222</span>     <span class="n">use_fsspec</span><span class="o">=</span><span class="n">use_fsspec</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">223</span>     <span class="n">fsspec_kwargs</span><span class="o">=</span><span class="n">fsspec_kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">224</span>     <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">225</span> <span class="p">)</span>

<span class="nn">File ~/Documents/Code/repos/github/dysh/dysh-env-3.8/lib/python3.8/site-packages/astropy/io/fits/hdu/hdulist.py:482,</span> in <span class="ni">HDUList.fromfile</span><span class="nt">(cls, fileobj, mode, memmap, save_backup, cache, lazy_load_hdus, ignore_missing_simple, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">462</span> <span class="nd">@classmethod</span>
<span class="g g-Whitespace">    </span><span class="mi">463</span> <span class="k">def</span> <span class="nf">fromfile</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">464</span>     <span class="bp">cls</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">472</span>     <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">473</span> <span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">474</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">475</span><span class="sd">     Creates an `HDUList` instance from a file-like object.</span>
<span class="g g-Whitespace">    </span><span class="mi">476</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">479</span><span class="sd">     documentation for details of the parameters accepted by this method).</span>
<span class="g g-Whitespace">    </span><span class="mi">480</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">482</span>     <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_readfrom</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">483</span>         <span class="n">fileobj</span><span class="o">=</span><span class="n">fileobj</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">484</span>         <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">485</span>         <span class="n">memmap</span><span class="o">=</span><span class="n">memmap</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">486</span>         <span class="n">save_backup</span><span class="o">=</span><span class="n">save_backup</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">487</span>         <span class="n">cache</span><span class="o">=</span><span class="n">cache</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">488</span>         <span class="n">ignore_missing_simple</span><span class="o">=</span><span class="n">ignore_missing_simple</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">489</span>         <span class="n">lazy_load_hdus</span><span class="o">=</span><span class="n">lazy_load_hdus</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">490</span>         <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">491</span>     <span class="p">)</span>

<span class="nn">File ~/Documents/Code/repos/github/dysh/dysh-env-3.8/lib/python3.8/site-packages/astropy/io/fits/hdu/hdulist.py:1170,</span> in <span class="ni">HDUList._readfrom</span><span class="nt">(cls, fileobj, data, mode, memmap, cache, lazy_load_hdus, ignore_missing_simple, use_fsspec, fsspec_kwargs, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1167</span> <span class="k">if</span> <span class="n">fileobj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1168</span>     <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="n">_File</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1169</span>         <span class="c1"># instantiate a FITS file object (ffo)</span>
<span class="ne">-&gt; </span><span class="mi">1170</span>         <span class="n">fileobj</span> <span class="o">=</span> <span class="n">_File</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1171</span>             <span class="n">fileobj</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1172</span>             <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1173</span>             <span class="n">memmap</span><span class="o">=</span><span class="n">memmap</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1174</span>             <span class="n">cache</span><span class="o">=</span><span class="n">cache</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1175</span>             <span class="n">use_fsspec</span><span class="o">=</span><span class="n">use_fsspec</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1176</span>             <span class="n">fsspec_kwargs</span><span class="o">=</span><span class="n">fsspec_kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1177</span>         <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1178</span>     <span class="c1"># The Astropy mode is determined by the _File initializer if the</span>
<span class="g g-Whitespace">   </span><span class="mi">1179</span>     <span class="c1"># supplied mode was None</span>
<span class="g g-Whitespace">   </span><span class="mi">1180</span>     <span class="n">mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span>

<span class="nn">File ~/Documents/Code/repos/github/dysh/dysh-env-3.8/lib/python3.8/site-packages/astropy/io/fits/file.py:218,</span> in <span class="ni">_File.__init__</span><span class="nt">(self, fileobj, mode, memmap, overwrite, cache, use_fsspec, fsspec_kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">216</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_open_fileobj</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">217</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
<span class="ne">--&gt; </span><span class="mi">218</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_open_filename</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">219</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">220</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_open_filelike</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">)</span>

<span class="nn">File ~/Documents/Code/repos/github/dysh/dysh-env-3.8/lib/python3.8/site-packages/astropy/io/fits/file.py:636,</span> in <span class="ni">_File._open_filename</span><span class="nt">(self, filename, mode, overwrite)</span>
<span class="g g-Whitespace">    </span><span class="mi">633</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">635</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_read_compressed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">magic</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="n">ext</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">636</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">IO_FITS_MODES</span><span class="p">[</span><span class="n">mode</span><span class="p">])</span>
<span class="g g-Whitespace">    </span><span class="mi">637</span>     <span class="bp">self</span><span class="o">.</span><span class="n">close_on_error</span> <span class="o">=</span> <span class="kc">True</span>
<span class="g g-Whitespace">    </span><span class="mi">639</span> <span class="c1"># Make certain we&#39;re back at the beginning of the file</span>
<span class="g g-Whitespace">    </span><span class="mi">640</span> <span class="c1"># BZ2File does not support seek when the file is open for writing, but</span>
<span class="g g-Whitespace">    </span><span class="mi">641</span> <span class="c1"># when opening a file for write, bz2.BZ2File always truncates anyway.</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;/data/gbt/examples/onoff-L/data/TGBT21A_501_11.raw.vegas.fits&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sdfits</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SCAN</th>
      <th>OBJECT</th>
      <th>VELOCITY</th>
      <th>PROC</th>
      <th>PROCSEQN</th>
      <th>RESTFREQ</th>
      <th>DOPFREQ</th>
      <th># IF</th>
      <th># POL</th>
      <th># INT</th>
      <th># FEED</th>
      <th>AZIMUTH</th>
      <th>ELEVATIO</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>152.0</td>
      <td>NGC2415</td>
      <td>3784.0</td>
      <td>OnOff</td>
      <td>1.0</td>
      <td>1.617185</td>
      <td>1.420406</td>
      <td>5</td>
      <td>2</td>
      <td>151</td>
      <td>1</td>
      <td>286.218008</td>
      <td>41.62843</td>
    </tr>
    <tr>
      <th>1</th>
      <td>153.0</td>
      <td>NGC2415</td>
      <td>3784.0</td>
      <td>OnOff</td>
      <td>2.0</td>
      <td>1.617185</td>
      <td>1.420406</td>
      <td>5</td>
      <td>2</td>
      <td>151</td>
      <td>1</td>
      <td>286.886521</td>
      <td>41.118134</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psscan</span> <span class="o">=</span> <span class="n">sdfits</span><span class="o">.</span><span class="n">getps</span><span class="p">(</span><span class="mi">152</span><span class="p">,</span> <span class="n">ifnum</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">plnum</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">psscan</span><span class="o">.</span><span class="n">calibrate</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PSSCAN nrows = 302
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T_sys = </span><span class="si">{</span><span class="n">psscan</span><span class="o">.</span><span class="n">tsys</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>T_sys = 17.17
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ta</span> <span class="o">=</span> <span class="n">psscan</span><span class="o">.</span><span class="n">timeaverage</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="s1">&#39;tsys&#39;</span><span class="p">)</span>
<span class="n">ta</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../_images/9505513dc153a24a1c783218d90fa835407b5bcc406efe1e00a29c1087eca28a.png" src="../../../../../_images/9505513dc153a24a1c783218d90fa835407b5bcc406efe1e00a29c1087eca28a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ta</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xaxis_unit</span><span class="o">=</span><span class="s2">&quot;km/s&quot;</span><span class="p">,</span><span class="n">yaxis_unit</span><span class="o">=</span><span class="s2">&quot;mK&quot;</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mi">100</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">xmin</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span><span class="n">xmax</span><span class="o">=</span><span class="mi">4500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../_images/0095744e25790895377947753488ccc89531b65e35a15bf3baf8b93a9f545f05.png" src="../../../../../_images/0095744e25790895377947753488ccc89531b65e35a15bf3baf8b93a9f545f05.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kms</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ta</span><span class="o">.</span><span class="n">baseline</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="mi">3600</span><span class="o">*</span><span class="n">kms</span><span class="p">,</span><span class="mi">4100</span><span class="o">*</span><span class="n">kms</span><span class="p">],</span><span class="n">remove</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>EXCLUDING [Spectral Region, 1 sub-regions:
  (1401242184.363393 Hz, 1403551474.1090915 Hz) 
]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: The fit may be poorly conditioned
 [astropy.modeling.fitting]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ta</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ymin</span><span class="o">=-</span><span class="mi">250</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../_images/53aadc32ee80f7308a02ccf8df4fba75722b1b35544e3c36448b562d9bffcced.png" src="../../../../../_images/53aadc32ee80f7308a02ccf8df4fba75722b1b35544e3c36448b562d9bffcced.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ta</span><span class="o">.</span><span class="n">baseline_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model: Polynomial1D
Inputs: (&#39;x&#39;,)
Outputs: (&#39;y&#39;,)
Model set size: 1
Degree: 2
Parameters:
             c0                   c1                    c2          
             K                  K / Hz               K / Hz2        
    ------------------- --------------------- ----------------------
    0.16984671256725348 6.155580136474429e-29 2.2305011385559243e-56
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ta</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;baselined_removed.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Green Bank Observatory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>